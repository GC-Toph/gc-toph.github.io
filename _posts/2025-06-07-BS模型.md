---
title: Black-Scholes-Merton模型
date: 2025-06-07 00:00:00 +0800
last_modified_at: 2025-06-07 00:00:00 +0800
categories: [不可解] # 最多两层
tags: [Beatrice, SDE]
# toc: false # 关闭目录
math: true
mermaid: true # diagram generation
---

## 核心思想

**通过构建一个无风险对冲投资组合来消除标的资产价格的随机性，再利用无套利原理推导出衍生品（如期权）的定价偏微分方程。**

---

## 符号定义

| 符号        | 含义                                               |
| ----------- | -------------------------------------------------- |
| $ S $       | 标的资产（如股票）价格，是随机过程                 |
| $ V(S, t) $ | 衍生品（如期权）价格，是 $ S $ 和时间 $ t $ 的函数 |
| $ \Pi $     | 构建的投资组合价值                                 |
| $ \mu $     | 资产的预期年化收益率（漂移项）                     |
| $ \sigma $  | 资产的年化波动率（风险度量）                       |
| $ r $       | 无风险利率（常数）                                 |

---

## 几何布朗运动（GBM）

假设资产价格短期内服从**几何布朗运动**：

$$
dS = \mu S \, dt + \sigma S \, dz
$$

- **漂移项**：$ \mu S \, dt $ 表示确定性增长趋势；
- **扩散项**：$ \sigma S \, dz $ 表示由随机冲击引起的波动。
- 标准维纳过程的微分增量 $ dz $：满足 $ dz \sim \mathcal{N}(0, dt) $

---

## 构建无风险对冲组合

### 投资组合构造

构建一个由**1 份衍生品多头**和**$ \Delta $ 份标的资产空头**组成的投资组合：

$$
\Pi = V - \Delta S
$$

其中，选择对冲比率：

$$
\Delta = \frac{\partial V}{\partial S}
$$

> 这一选择使得对冲组合对标的资产价格的**一阶变动**无关。

### 组合价值的瞬时变化

在无穷小时间 $ dt $ 内，组合价值变化为：

$$
d\Pi = dV - \Delta \, dS = dV - \frac{\partial V}{\partial S} dS
$$

---

## 伊藤引理（Itô’s Lemma）

由于 $ V = V(S, t) $，且 $ S $ 是随机过程，需使用**伊藤引理**展开 $ dV $：

$$
dV = \frac{\partial V}{\partial t} dt + \frac{\partial V}{\partial S} dS + \frac{1}{2} \frac{\partial^2 V}{\partial S^2} (dS)^2
$$

### 计算 $ (dS)^2 $

代入 $ dS = \mu S dt + \sigma S dz $，得：

$$
(dS)^2 = (\mu S dt + \sigma S dz)^2 = \mu^2 S^2 (dt)^2 + 2\mu\sigma S^2 dt\,dz + \sigma^2 S^2 (dz)^2
$$

根据伊藤微积分规则（当 $ dt \to 0 $）：

- $ (dt)^2 \to 0 $
- $ dt \cdot dz \to 0 $
- $ (dz)^2 = dt $

因此：

$$
(dS)^2 \approx \sigma^2 S^2 \, dt
$$

### 代入伊藤引理

$$
dV = \frac{\partial V}{\partial t} dt + \frac{\partial V}{\partial S} (\mu S dt + \sigma S dz) + \frac{1}{2} \frac{\partial^2 V}{\partial S^2} \sigma^2 S^2 dt
$$

整理得：

$$
dV = \left( \frac{\partial V}{\partial t} + \mu S \frac{\partial V}{\partial S} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} \right) dt + \sigma S \frac{\partial V}{\partial S} dz
$$

---

## 代入对冲组合并消除随机性

将 $ dV $ 和 $ dS $ 代入 $ d\Pi = dV - \frac{\partial V}{\partial S} dS $：

$$
d\Pi = \left[ \left( \frac{\partial V}{\partial t} + \mu S \frac{\partial V}{\partial S} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} \right) dt + \sigma S \frac{\partial V}{\partial S} dz \right] - \frac{\partial V}{\partial S} (\mu S dt + \sigma S dz)
$$

展开后：

- **随机项（含 $ dz $）**：
  $$
  \sigma S \frac{\partial V}{\partial S} dz - \frac{\partial V}{\partial S} \sigma S dz = 0
  $$

- **确定性项（含 $ dt $）**：
  $$
  \left( \frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} \right) dt
  $$

因此，**对冲后的组合无随机性**：

$$
d\Pi = \left( \frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} \right) dt
$$

---

## 无套利原理与 Black-Scholes PDE

由于 $ \Pi $ 是**无风险组合**，其收益率必须等于无风险利率 $ r $，否则存在套利机会。

无风险资产的增长满足：

$$
d\Pi = r \Pi \, dt
$$

将两种表达式联立：

$$
\left( \frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} \right) dt = r \left( V - S \frac{\partial V}{\partial S} \right) dt
$$

两边除以 $ dt $，整理得 **Black-Scholes 偏微分方程（PDE）**：

$$
\frac{\partial V}{\partial t} + r S \frac{\partial V}{\partial S} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} - rV = 0
$$

---

## 希腊字母

- **Delta ($ \Delta $)**：$ \frac{\partial V}{\partial S} $，对冲比率；
- **Gamma ($ \Gamma $)**：$ \frac{\partial^2 V}{\partial S^2} $，Delta 对价格的敏感度；
- **Theta ($ \Theta $)**：$ \frac{\partial V}{\partial t} $，时间衰减。

---

## PDE 求解

### 变量分类

在实际应用中，我们将 Black-Scholes PDE 中的变量分为三类：

#### 可观测的输入

这些是市场数据或合约条款，可以直接获取：

| 符号  | 含义                         | 说明                                  |
| ----- | ---------------------------- | ------------------------------------- |
| $ S $ | 标的资产现价                 | 股票等标的资产的当前市场价格          |
| $ K $ | 行权价（Strike Price）       | 期权合约约定的执行价格                |
| $ T $ | 到期日（Expiry Date）        | 通常使用剩余到期时间 $ \tau = T - t $ |
| $ r $ | 无风险利率（Risk-Free Rate） | 与期权期限匹配的国债收益率            |
| $ q $ | 股息率（Dividend Yield）     | 若标的资产支付股息，则需引入          |

#### 不可直接观测的输入

| 符号       | 含义                 |
| ---------- | -------------------- |
| $ \sigma $ | 波动率（Volatility） |

- **估计方法**：
  - **历史波动率**：基于过去价格收益率的标准差，反映历史波动，未必代表未来。
  - **隐含波动率（Implied Volatility, IV）**：**市场标准做法**。将市场实际交易的期权价格 $ V_{\text{market}} $ 与其他已知参数代入 Black-Scholes 公式，**反向求解**出使模型价格等于市场价格的 $ \sigma $。  
    > 即：求解 $ V_{\text{BS}}(S, K, T, r, \sigma) = V_{\text{market}} $ 中的 $ \sigma $

#### 最终要求解的V

| 符号        | 含义                           | 目标                         |
| ----------- | ------------------------------ | ---------------------------- |
| $ V(S, t) $ | 衍生品价格（Derivative Price） | **理论公允价值**，即模型输出 |

**求解目标**：  
> 找到一个**具体的定价函数** $ V(S, t) $，使其满足该 PDE **以及特定衍生品的边界条件与终值条件**。

该函数 $ V(S, t) $ 的作用是：  
> 给定任意时刻 $ t < T $ 和任意标的资产价格 $ S $，输出该衍生品的**理论公允价值**。

$$
\frac{\partial V}{\partial t} + r S \frac{\partial V}{\partial S} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} - rV = 0
$$

### 解析解

- **适用对象**：欧式期权等结构简单、边界条件明确的衍生品。
- **方法**：通过变量代换（如 $ x = \ln S $, $ \tau = T - t $）将 PDE 转化为**热传导方程**求解。
- **优点**：结果精确、计算极快。
- **缺点**：**无法处理美式期权**（因提前行权导致自由边界问题）。

对于欧式看涨期权，终值条件为：

$$
V(S, T) = \max(S - K, 0)
$$

求解 PDE 得到著名的 **Black-Scholes 定价公式**：

$$
C(S, t) = S N(d_1) - K e^{-r(T - t)} N(d_2)
$$

其中：

$$
d_1 = \frac{\ln(S/K) + (r + \frac{1}{2}\sigma^2)(T - t)}{\sigma \sqrt{T - t}}, \quad
d_2 = d_1 - \sigma \sqrt{T - t}
$$

$ N(\cdot) $ 为标准正态分布的累积分布函数。

### 数值方法

当解析解不存在时，使用数值近似。

#### 1. 有限差分法（Finite Difference Method, FDM）

- **核心思想**：将连续的 $ (S, t) $ 平面离散化为网格，用差商近似偏导数。
  $$
  \frac{\partial V}{\partial t} \approx \frac{V^{n+1}_i - V^n_i}{\Delta t}, \quad
  \frac{\partial^2 V}{\partial S^2} \approx \frac{V^n_{i+1} - 2V^n_i + V^n_{i-1}}{(\Delta S)^2}
  $$
- **求解方向**：从到期日 $ t = T $（已知终值）**向后倒推**至当前时刻 $ t = 0 $。
- **优点**：通用性强，可处理美式期权（通过在每步判断是否行权）、时变参数等。
- **缺点**：实现较复杂，计算量较大。

#### 2. 二叉树/三叉树模型（Binomial/Trinomial Tree）

- **核心思想**：对标的资产**价格路径进行离散化**建模。
  - 每步：$ S \to uS $（上涨）或 $ S \to dS $（下跌），其中 $ u = e^{\sigma \sqrt{\Delta t}}, d = 1/u $
- **定价过程**：
  1. 构建价格树至到期日；
  2. 在叶节点计算期权 payoff；
  3. 从后往前，按风险中性概率折现：  
     $$
     V = e^{-r \Delta t} [p V_{\text{up}} + (1 - p) V_{\text{down}}]
     $$
     其中 $ p = \frac{e^{r \Delta t} - d}{u - d} $
- **优点**：直观、天然支持**美式期权**（每节点比较行权价值与持有价值）。
- **缺点**：收敛速度慢，高维问题效率低。

#### 3. 蒙特卡洛模拟（Monte Carlo Simulation）

- **核心思想**：基于**风险中性定价原理**，不直接解 PDE，而是模拟未来路径。
- **步骤**：
  1. 在风险中性测度下模拟 $ N $ 条资产价格路径：  
     $$
     S_{t+\Delta t} = S_t \exp\left( (r - \frac{1}{2}\sigma^2)\Delta t + \sigma \sqrt{\Delta t} \, \epsilon \right), \quad \epsilon \sim \mathcal{N}(0,1)
     $$
  2. 计算每条路径到期收益 $ \text{Payoff}_i $
  3. 估算价格：  
     $$
     V \approx e^{-r(T - t)} \cdot \frac{1}{N} \sum_{i=1}^N \text{Payoff}_i
     $$
- **优点**：**极其灵活**，适用于路径依赖期权（如亚式、回望、障碍期权）。
- **缺点**：
  - 无法直接处理**美式期权**（因需最优停止决策）；
  - 收敛速度慢（误差 $ \propto 1/\sqrt{N} $）, 需大量模拟路径以保证精度。

![warning](/assets/images/warning.jpg)
